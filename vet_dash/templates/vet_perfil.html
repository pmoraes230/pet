{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="bg-gray-50 flex h-screen overflow-hidden">
    <!-- CAMINHOS CORRIGIDOS BASEADOS NA SUA IMAGEM -->
    {% include "partials/aside/aside_vet.html" %}
    
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        {% include "partials/header/header_vet.html" %}

        <div class="flex-1 overflow-y-auto p-6 md:p-10 pb-24">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-2xl font-bold text-gray-800 mb-8 text-center">Configurações de Perfil</h2>

                <form method="post" enctype="multipart/form-data" class="space-y-8">
                    {% csrf_token %}

                    <!-- FOTO DE PERFIL EM FORMATO DE BOLA E CENTRALIZADA -->
                    <div class="bg-white rounded-3xl p-8 shadow-sm border border-gray-100 flex flex-col items-center justify-center">
                        <div class="relative">
                            <!-- Moldura Circular -->
                            <div class="w-32 h-32 rounded-full border-4 border-[#26C2B9] shadow-lg overflow-hidden bg-gray-50 flex items-center justify-center">
                                {% if veterinario.imagem_perfil_veterinario %}
                                    <img id="foto-preview" src="{{ veterinario.imagem_perfil_veterinario.url }}" class="w-full h-full object-cover">
                                {% else %}
                                    <!-- Placeholder com inicial se não houver foto -->
                                    <div id="placeholder-vet" class="w-full h-full bg-[#26C2B9] flex items-center justify-center text-white text-4xl font-black">
                                        {{ veterinario.nome|slice:":1"|upper }}
                                    </div>
                                    <img id="foto-preview" src="" class="w-full h-full object-cover hidden">
                                {% endif %}
                            </div>

                            <!-- Botão Flutuante (Câmera) -->
                            <label for="input-foto" class="absolute bottom-0 right-0 bg-[#26C2B9] p-2.5 rounded-full text-white cursor-pointer hover:scale-110 transition-transform shadow-md border-2 border-white">
                                <i data-lucide="camera" width="18" height="18"></i>
                                <input type="file" id="input-foto" name="image_veterinario" class="hidden" onchange="previewImage(this)" accept="image/*">
                            </label>
                        </div>
                        <p class="text-xs font-bold text-gray-400 mt-4 uppercase tracking-widest">Foto de Perfil</p>
                    </div>

                    <!-- Dados Pessoais -->
                    <div class="bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-6 flex items-center gap-2 border-b pb-4">
                            <i data-lucide="user" class="w-5 h-5 text-[#26C2B9]"></i>
                            Dados Pessoais
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="flex flex-col gap-1">
                                <label class="text-xs font-black text-gray-400 uppercase">Nome completo</label>
                                <input type="text" name="nome" value="{{ veterinario.nome }}" required
                                       class="w-full px-4 py-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-[#26C2B9] font-bold text-gray-700">
                            </div>
                            <div class="flex flex-col gap-1">
                                <label class="text-xs font-black text-gray-400 uppercase">E-mail</label>
                                <input type="email" name="email" value="{{ veterinario.email }}"
                                       class="w-full px-4 py-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-[#26C2B9] font-bold text-gray-700">
                            </div>
                            <div class="flex flex-col gap-1">
                                <label class="text-xs font-black text-gray-400 uppercase">CRMV</label>
                                <input type="text" name="crmv" value="{{ veterinario.crmv }}"
                                       class="w-full px-4 py-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-[#26C2B9] font-bold text-gray-700">
                            </div>
                            <div class="flex flex-col gap-1">
                                <label class="text-xs font-black text-gray-400 uppercase">Estado (UF)</label>
                                <input type="text" name="uf_crmv" value="{{ veterinario.uf_crmv }}"
                                       class="w-full px-4 py-3 bg-gray-50 border-none rounded-xl focus:ring-2 focus:ring-[#26C2B9] font-bold text-gray-700">
                            </div>
                        </div>
                    </div>

                    <!-- Botões -->
                    <div class="flex justify-end gap-4">
                        <a href="{% url 'dash_veterinario' %}" class="px-8 py-3 border border-gray-200 rounded-xl font-bold text-gray-400 hover:bg-gray-100 transition-all">Cancelar</a>
                        <button type="submit" class="px-10 py-3 bg-[#26C2B9] text-white rounded-xl font-black shadow-lg shadow-teal-100 hover:bg-[#1ea8a1] transition-all">
                            Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>
</div>

<!-- Script para Preview da Foto e Ícones -->
<script>
function previewImage(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            const preview = document.getElementById('foto-preview');
            const placeholder = document.getElementById('placeholder-vet');
            preview.src = e.target.result;
            preview.classList.remove('hidden');
            if (placeholder) placeholder.classList.add('hidden');
        }
        reader.readAsDataURL(input.files[0]);
    }
}
// Ativa ícones do Lucide
lucide.createIcons();
</script>
{% endblock %}