{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="bg-gray-50 flex flex-col md:flex-row h-screen overflow-hidden">
    
    <!-- SIDEBAR FIXA DO VETERINÁRIO -->
    {% include "partials/aside/aside_vet.html" %}

    <!-- O segredo está nestas classes: flex-col h-screen -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        
        <!-- HEADER FIXO DO VETERINÁRIO (Ele fica aqui, fora da div de scroll) -->
        {% include "partials/header/header_vet.html" %}

        <!-- Conteúdo das Notificações (Esta div é a única que rola) -->
        <div class="flex-1 overflow-y-auto p-6 md:p-10 pb-24">
            <div class="max-w-4xl mx-auto">
                
                <!-- Título e Contador -->
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-3xl font-black text-gray-800 tracking-tight">Central de Alertas</h2>
                        <p class="text-gray-400 font-bold">Histórico de interações com seus pacientes e tutores.</p>
                    </div>
                    <div class="bg-white px-4 py-2 rounded-2xl border border-gray-100 shadow-sm">
                         <span class="text-xs font-black text-gray-400 uppercase tracking-widest text-teal-600">
                            {{ notificacoes.count }} registros
                        </span>
                    </div>
                </div>

                <!-- Lista de Notificações -->
                <div class="space-y-4">
                    {% for n in notificacoes %}
                    
                    {% if n.tipo == 'mensagem' %}
                        <a href="/mensagens_vet/?tutor_id={{ n.tutor_id }}" class="block transition-transform active:scale-[0.98]">
                    {% elif n.tipo == 'consulta' %}
                        <a href="/agenda_vet/" class="block transition-transform active:scale-[0.98]">
                    {% else %}
                        <a href="#" class="block cursor-default">
                    {% endif %}

                        <div class="bg-white rounded-[2rem] p-6 border {% if not n.lida %}border-teal-200 bg-teal-50/10{% else %}border-gray-100{% endif %} shadow-sm flex items-center gap-6 hover:shadow-md hover:border-teal-400 transition-all group">
                            
                            <div class="w-14 h-14 rounded-2xl flex items-center justify-center flex-shrink-0
                                {% if n.tipo == 'consulta' %} bg-teal-50 text-[#26C2B9] 
                                {% elif n.tipo == 'vacina' %} bg-purple-50 text-purple-600 
                                {% elif n.tipo == 'mensagem' %} bg-blue-50 text-blue-500
                                {% else %} bg-gray-50 text-gray-500 {% endif %}">
                                <i data-lucide="{% if n.tipo == 'consulta' %}calendar{% elif n.tipo == 'vacina' %}syringe{% elif n.tipo == 'mensagem' %}message-square{% else %}bell{% endif %}" width="24"></i>
                            </div>

                            <div class="flex-1">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">
                                        {{ n.tipo|default:"Aviso" }}
                                    </span>
                                    <span class="text-[10px] font-bold text-gray-400 flex items-center gap-1">
                                        <i data-lucide="clock" width="10"></i>
                                        {{ n.data_criacao|date:"d/m/Y" }} às {{ n.data_criacao|date:"H:i" }}
                                    </span>
                                </div>
                                
                                <p class="text-gray-800 font-bold text-lg leading-tight">{{ n.mensagem }}</p>
                                
                                {% if n.tipo == 'mensagem' %}
                                <span class="text-teal-600 text-[10px] font-black uppercase mt-2 block group-hover:underline">Abrir conversa com tutor →</span>
                                {% endif %}
                            </div>

                            <div class="flex flex-col items-end gap-2">
                                {% if not n.lida %}
                                    <div class="w-2.5 h-2.5 bg-teal-500 rounded-full shadow-[0_0_8px_rgba(20,184,166,0.5)]"></div>
                                {% endif %}
                                <i data-lucide="chevron-right" class="text-gray-300 group-hover:text-teal-500 transition-colors" width="20"></i>
                            </div>
                        </div>
                    </a>
                    {% empty %}
                    <div class="text-center py-24 bg-white rounded-[3rem] border-2 border-dashed border-gray-100">
                        <i data-lucide="bell-off" class="mx-auto text-gray-200 mb-4" width="48"></i>
                        <p class="text-gray-400 font-black italic">Nenhuma notificação encontrada.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </main>
</div>
{% endblock %}